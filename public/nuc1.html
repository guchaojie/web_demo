<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="Content-Language" content="en" />
        <meta name="robots" content="all" />
        <meta name="author" content="IoT_Gateway" />
        <meta name="Copyright" content="Copyright intel All Rights Reserved." />
        <title>Gateway Data--NUC1</title>
        <link rel="stylesheet" type="text/css" href="styles/pure.css" />
        <link rel="stylesheet" type="text/css" href="styles/menu.css" />
        <link rel="stylesheet" type="text/css" href="styles/style.css" />
	<script src="Chart.js/Chart.js"></script>
    </head>

    <body>
        <div id="container">
            <a href="home.html"><img border="0" src="images/banner.jpg" width=100% height="68px"></a>
        <div id='cssmenu'>
           <ul>
             <li><a href='home.html'><span>Home</span></a></li>
             <li class='has-sub'><a href='#'><span>Documentation</span></a>
                <ul>
                    <li><a href='advantages.html'><span>Advantages</span></a></li>
                    <li><a href='install.html'><span>Install</span></a></li>
                    <li><a href='faq.html'><span>FAQ</span></a></li>
                </ul>
             </li>
             <li><a href='download.html'><span>Download</span></a></li>
             <li class='last'><a href='about.html'><span>About</span></a></li>
           </ul>
          </div>
            <div id='sidebar'>
                <div class="pure-menu pure-menu-open">
                    <ul>
                        <li><a href="home.html">Overview</a></li>
                        <li><a href="nuc1.html">NUC 1</a></li>
                        <li><a href="nuc2.html">NUC 2</a></li>
                    </ul>
                </div>
            </div>

            <div id="content">
		 <table class="pure-table pure-table-bordered" align="center">
		     <caption>Nuc1 Sensor Status Details</caption>
                     <thead>
		         <tr>
		             <th>#</th>
	                     <th>sensor_name</th>				     
			     <th>sensor_type</th>
			     <th>sensor_data</th>
			     <th>time_stamp</th>
		         </tr>
                     </thead>	       
		     <tbody id="table">
		     </tbody>
                 </table>	
		 <br />
		<div>
		<h4 align ="center">Light Sensor Analysis Chart</h4>
		<canvas id="canvas" width=150" height="50"></canvas>
		<br />
                <h4 align ="center">Misc Sensor Analysis Chart</h4>
                <br />
                <canvas id="canvas1" width=150" height="50"></canvas>
	        </div>
            </div>
        </div>      
        <div id="footer">
          <a href="home.html" >Home</a> | <a href="#">About Sensor Framework</a> <br />
          Copyright Â© 2015 The Sensor Framework Team
        </div>
    </body>
    <script>
        var light_time = new Array(7);
        var light_data = new Array(7);
        var misc_time = new Array(7);
        var misc_data = new Array(7);

        var request = function() {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "./data1", true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4) {
                   var rows = JSON.parse(xhr.responseText);
                   var tableContent = '';
                   for (var i in rows) {
                       var row = rows[i];
                       var str = '<tr><td>'+row.device+'</td><td>'+row.sensor_name+'</td><td>'
			         +row.sensor_type+'</td><td>'+row.sensor_data+'</td><td>'+row.time_stamp+'</td></tr>'
                       tableContent += str;
		      
                   }
                   document.getElementById("table").innerHTML = tableContent;
               }
           }
           xhr.send();
       }

       request();
       setInterval(request, 3000);	

       var request1 = function() {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "./datalight", true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4) {
                   var rows = JSON.parse(xhr.responseText);
                   for (var i in rows) {
                       var row = rows[i];
                       light_time[i] = row.time_stamp;
		       light_data[i] = row.sensor_data;

                   }

		   if (light_time[0]) {
		      var lineChartData1 = { labels : [light_time[0],light_time[1],light_time[2],
			                              light_time[3],light_time[4],light_time[5],light_time[6]],
	                   datasets : [
			     { 
			      label: "My First dataset",
			      fillColor : "rgba(220,220,220,0.2)",
			      strokeColor : "rgba(220,220,220,1)",
			      pointColor : "rgba(220,220,220,1)",
			      pointStrokeColor : "#fff",
			      pointHighlightFill : "#fff",
			      pointHighlightStroke : "rgba(220,220,220,1)",
			      data : [light_data[0],light_data[1],light_data[2],
			              light_data[3],light_data[4],light_data[5],light_data[6]]
			     }
			   ]
                        };

	                   var ctx = document.getElementById("canvas").getContext("2d");
	                   window.myLine = new Chart(ctx).Line(lineChartData1, { responsive: true });
		   }
        
                   

               }
           }
           xhr.send();
       }

       request1();
       setInterval(request1, 3000);

       var request2 = function() {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "./datamisc1", true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4) {
                   var rows = JSON.parse(xhr.responseText);
                   for (var i in rows) {
                       var row = rows[i];
                       misc_time[i] = row.time_stamp;
		       misc_data[i] = row.sensor_data;

                   }

		   if (misc_time[0]) {
		      var lineChartData = { labels : [misc_time[0],misc_time[1],misc_time[2],
			                              misc_time[3],misc_time[4],misc_time[5],misc_time[6]],
	                   datasets : [
			     { 
			       label: "My Second dataset",
			       fillColor : "rgba(151,187,205,0.2)",
			       strokeColor : "rgba(151,187,205,1)",
			       pointColor : "rgba(151,187,205,1)",
			       pointStrokeColor : "#fff",
			       pointHighlightFill : "#fff",
			       pointHighlightStroke : "rgba(151,187,205,1)",
			      data : [misc_data[0],misc_data[1],misc_data[2],
			              misc_data[3],misc_data[4],misc_data[5],misc_data[6]]
			     }
			   ]
                        };

	                   var ctx = document.getElementById("canvas1").getContext("2d");
	                   window.myLine = new Chart(ctx).Line(lineChartData, { responsive: true });
		   }
        
                   

               }
           }
           xhr.send();
       }

       request2();
       setInterval(request2, 3000);
   </script>
</html>
